%I A389148 #6 Sep 24 2025 23:02:56
%S A389148 527,611,713,731,779,893,923,1003,1037,1271,1273,1343,1349,1357,1411,
%T A389148 1469,1591
%N A389148 Composite numbers e>6 for which there is no 1<=a<b<c<d<e for which a!b!c!d!e! is a perfect square.
%C A389148 The condition that e is composite and at least 6 is necessary to have 1<=a<b<c<d<e with a!b!c!d!e! a perfect square. [Erdős-Graham]
%C A389148 Multiples of 2, 3, 5, 7, or 11 are not in this sequence, due to identities such as 11! (7m-1)! (7m)! (11m-1)! (11m)! always being a perfect square [Erdős-Graham, Fact 7]
%C A389148 Is a subsequence of A005117 [Erdős-Graham]
%C A389148 Almost all numbers 13p with p prime lie in the sequence [Erdős-Graham, Theorem 3]
%C A389148 Conjectured to have positive (lower) density [Erdős-Graham]; see also Erdos problem #374.  Also conjectured that almost all elements of A001358 lie in this sequence. [Erdős-Graham]
%C A389148 The set F_5 in [Erdős-Graham] consists of the complement of the union of this sequence and A000040.
%C A389148 Is somewhat difficult to compute this sequence efficiently by pure brute force; some optimization is required
%H A389148 Thomas Bloom, <a href="https://www.erdosproblems.com/374">Problem 374</a>, Erdős Problems.
%H A389148 P. Erdős and R. L. Graham, <a href="https://old.renyi.hu/~p_erdos/1976-25.pdf">On products of factorials, Bull. Inst. Math. Acad. Sinica 4 (1976), pp. 337-355.
%H A389148 P. Erdős and R. L. Graham, <a href="https://fanchung.ucsd.edu/ron/papers/80_11_number_theory.pdf">Old and new problems and results in combinatorial number theory</a>, Monographies de L'Enseignement Mathématique (1980).
%e A389148 The first element is 527 [Erdős-Graham, Fact 14]
%o A389148 (Python) import sympy as sp
%o A389148 import numpy as np
%o A389148 N = 1600
%o A389148 primes = list(sp.primerange(2, N+1))
%o A389148 table = np.zeros((N+1, len(primes)), dtype=np.uint8)
%o A389148 for n in range(2, N+1):
%o A389148     factors = sp.factorint(n)
%o A389148     for j, p in enumerate(primes):
%o A389148         if p in factors:
%o A389148             table[n, j] = factors[p] % 2
%o A389148 def test(e): # assumes 6 < e <= N
%o A389148     fac1 = np.zeros(len(primes), dtype=np.uint8)
%o A389148     for d in reversed(range(1,e)):
%o A389148         if d+1 in primes:
%o A389148             return False
%o A389148         fac1 += table[d+1]
%o A389148         for c in reversed(range(1,d)):
%o A389148           fac2 = fac1 % 2
%o A389148           for b in reversed(range(1,c)):
%o A389148               if b+1 in primes:
%o A389148                   if fac1[primes.index(b+1)] == 0:
%o A389148                       break
%o A389148               fac2 += table[b+1]
%o A389148               fac3 = fac2 % 2
%o A389148               for a in range(1,b):
%o A389148                   fac3 += table[a]
%o A389148                   if np.all(fac3 % 2 == 0):
%o A389148                       return True
%o A389148     return False
%Y A389148 Cf. A388851, A387184
%Y A389148 Contained in A005117.  Conjectured to contain most of A001358
%K A389148 nonn,new
%O A389148 1,1
%A A389148 _Terence Tao_, Sep 24 2025
