%I A180887 #11 Apr 22 2025 14:08:23
%S A180887 2,3,3,6,12,6,10,50,50,10,20,160,360,160,20,35,525,1960,1960,525,35,
%T A180887 70,1540,10010,17080,10010,1540,70,126,4662,45738,130914,130914,45738,
%U A180887 4662,126,252,13104,203616,877968,1438920,877968,203616,13104,252,462,38346
%N A180887 Array read by antidiagonals: T(n,k)=number of permutations p() of 1..n+k with centered difference p(i+1)-p(i-1) < 0 exactly k-1 times.
%H A180887 R. H. Hardin, <a href="/A180887/b180887.txt">Table of n, a(n) for n=1..10000</a>
%e A180887 Table starts:
%e A180887     2      3        6        10          20            35             70
%e A180887     3     12       50       160         525          1540           4662
%e A180887     6     50      360      1960       10010         45738         203616
%e A180887    10    160     1960     17080      130914        877968        5517204
%e A180887    20    525    10010    130914     1438920      13547688      116189304
%e A180887    35   1540    45738    877968    13547688     174550992     1997701992
%e A180887    70   4662   203616   5517204   116189304    1997701992    29868078240
%e A180887   126  13104   854700  32369568   917857512   20732684544   398942612640
%e A180887   252  38346  3560172 183346020  6866412696  200430861345  4892905415970
%e A180887   462 105336 14299428 997586304 48911180175 1825340594220 55931879316170
%o A180887 (bc)
%o A180887 /* Formula r(n,k) from A000892 */
%o A180887 define factorial(n) {
%o A180887 auto prod;
%o A180887 prod=1;
%o A180887 while(n>=2)prod*=n--;
%o A180887 return prod;
%o A180887 }
%o A180887 define binomial(n,i) {
%o A180887 if(i<0||i>n)return 0;
%o A180887 return factorial(n)/(factorial(i)*factorial(n-i));
%o A180887 }
%o A180887 define r(n,k) {
%o A180887 auto j,sum;
%o A180887 sum=0;
%o A180887 for(j=0; j<=k+1; j++) {
%o A180887 sum+=(-1)^j*(k+1-j)^n*binomial(n+1,j);
%o A180887 }
%o A180887 return sum;
%o A180887 }
%o A180887 define t(n,k) {
%o A180887 auto sum,i;
%o A180887 sum=0;
%o A180887 for(i=0; i<=(k-1); i++)sum+=r((n+k)/2,i)*r((n+k)-(n+k)/2,(k-1)-i);
%o A180887 return sum*binomial((n+k),(n+k)/2);
%o A180887 }
%o A180887 for(index=1; index<=10000; index++) {
%o A180887 n=n+1; k=k-1; if(k<=0) { k=n; n=1; }
%o A180887 print index, " ", t(n,k), "\n";
%o A180887 }
%o A180887 quit
%Y A180887 Columns 1..9 are A001405(n+1), A180879, A180880, A180881, A180882, A180883, A180884, A180885, A180886.
%K A180887 nonn,tabl
%O A180887 1,1
%A A180887 _R. H. Hardin_, Sep 23 2010
